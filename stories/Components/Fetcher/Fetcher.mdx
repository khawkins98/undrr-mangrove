import { Meta, Story, Canvas, Source } from '@storybook/blocks';
import Fetcher from './Fetcher';
import * as FetcherStories from './Fetcher.stories';

<Meta of={FetcherStories} />

# Fetcher

The `Fetcher` component is a flexible data-fetching utility for Preact/React applications.

## Props

* **`api`**: `string` - The URL of the API endpoint. *(required)*
* **`render`**: `function` - A function to render the UI based on the fetched data. *(required)*
* **`queryParams`**: `object` - Additional query parameters to send with the API request. *(optional)*
* **`loadingLabel`**: `string` - A label to display while loading. *(optional)*

## Stories

### Default

This is the default usage of the `Fetcher` component.

<Canvas />

<Source
  language="jsx"
  code={`
import Fetcher from './Fetcher';

const Default = () => {
  const renderData = ({ isLoading, data }) => (
    <div>
      {isLoading && <p>Loading data...</p>}
      <pre>{JSON.stringify(data, null, 4)}</pre>
    </div>
  );

  return (
    <Fetcher
      api="https://sfvc-migration.undrr.org/api/v2/content/commitments-metrics"
      queryParams={{ items_per_page: 10}}
      loadingLabel="Loading data"
      render={renderData}
    />
  );
};

export default Default;
`}
/>

### With Search Term

An example of the `Fetcher` component with a search term parameter.

<Canvas />

<Source
  language="jsx"
  code={`
import Fetcher from './Fetcher';

const WithSearchTerm = () => {
  const renderData = ({ isLoading, data }) => (
    <div>
      {isLoading  && <p>Searching...</p>}
      <pre>{JSON.stringify(data, null, 4)}</pre>
    </div>
  );

  return (
    <Fetcher
      api="https://sfvc-migration.undrr.org/api/v2/content/commitments-metrics"
      queryParams={{ items_per_page: 10}}
      loadingLabel="Searching"
      render={renderData}
    />
  );
};

export default WithSearchTerm;
`}
/>

### Without Query Params

An example of the `Fetcher` component without query params.

<Canvas />

<Source
  language="jsx"
  code={`
import Fetcher from './Fetcher';

const WithoutQueryParams = () => {
  const renderData = ({ isLoading, data }) => (
    <div>
      {isLoading  && <p>loading metrics.......</p>}
      <pre>{JSON.stringify(data, null, 4)}</pre>
    </div>
  );

  return (
    <Fetcher
      api="https://sfvc-migration.undrr.org/api/v2/content/commitments-metrics"
      loadingLabel="loading metrics...."
      render={renderData}
    />
  );
};

export default WithoutQueryParams;
`}
/>

### Accessibility

Ensure that the `render` function used within `Fetcher` is accessible and handles data presentation properly for all users.

### Changelog

1.0 â€” Initial release of the component
