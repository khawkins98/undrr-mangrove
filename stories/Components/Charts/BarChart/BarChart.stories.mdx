import { Meta, Story, Canvas, Source } from '@storybook/addon-docs';
import BarChart from './BarChart';
import Fetcher from "../../Fetcher/Fetcher";

<Meta title="Components/Charts/BarChart" component={BarChart} />

# BarChart

The `BarChart` component renders a bar chart using D3 and React. It's designed to display data visually in a simple and effective way, making it easier to compare values across different categories.

Bar charts are particularly useful for comparing quantities corresponding to different groups or categories. The height of each bar is proportional to the values they represent.

## Props

- **`data`**: `Array<{ label: string, value: number, color: string }>` - An array of objects representing the data points. *(required)*
- **`width`**: `number` - The width of the chart in pixels. *(required)*
- **`height`**: `number` - The height of the chart in pixels. *(required)*
- **`margin`**: `Object<{ top: number, right: number, bottom: number, left: number }>` - An object representing the chart margins. (default: `{ top: 40, right: 30, bottom: 70, left: 70 }`)
- **`color`**: `string` - The default fill color for the bars.
- **`labelColor`**: `string` - The color for the bar labels. *(default: `#FFFFFF`)*
- **`title`**: `string` - The title of the chart.
- **`type`**: `string` - The type of the chart (`COMMITMENTS` | `ORGANISATIONS` | `DELIVERABLES`).
- **`axisColor`**: `string` - The color of the axis lines.
- **`tickColor`**: `string` - The color of the tick lines.
- **`xAxisLabel`**: `string` - The label for the x-axis. *(optional)*
- **`yAxisLabel`**: `string` - The label for the y-axis. *(optional)*
- **`dataSource`**: `string` - The data source description. *(optional)*
- **`ariaLabel`**: `string` - ARIA label for accessibility. *(default: "Bar chart showing data")*
- **`ariaDescription`**: `string` - A description of the chart content for screen readers.

## Usage

To use the `BarChart` component, import it into your React application and provide it with the required props.

### BarChart with Fetcher

Below is an example of the `BarChart` component wrapped inside the `Fetcher` component. This setup fetches data from an API and renders it in the bar chart.

<Canvas>
  <Story name="BarChart with Fetcher">
    {() => (
      <Fetcher
        api="https://sfvc-migration.undrr.org/api/v2/content/commitments-metrics"
        queryParams={{items_per_page:1000}}
        render={({ isLoading, data }) => (
          <>
            {isLoading ? (
              <span>Loading data.</span>
            ) : (
              <BarChart
                data={data}
                width={1000}
                height={300}
                margin={{ top: 0, right: 0, bottom: 0, left: 0 }}
                labelColor="#9CA3AF"
                axisColor="#9CA3AF"
                tickColor="none"
                title=""
                type="COMMITMENTS"
                xAxisLabel=""
                yAxisLabel=""
                dataSource=""
                ariaLabel="Bar chart showing the number of commitments by year"
                ariaDescription="This chart displays the number of commitments made each year based on fetched API data."
              />
            )}
          </>
        )}
      />
    )}
  </Story>
</Canvas>

<Source
  language="jsx"
  code={`
import React from 'react';
import BarChart from './BarChart';
import Fetcher from '../../Fetcher/Fetcher';

const BarChartWithOrganisation = () => (
  <Fetcher
    api="https://sfvc-migration.undrr.org/api/v2/content/commitments-metrics"
    queryParams={{items_per_page:1000}}
    render={({ isLoading, data }) => (
      <>
        {isLoading ? (
          <span>Loading data.</span>
        ) : (
          <BarChart
            data={data}
            width={1000}
            height={300}
            margin={{ top: 0, right: 0, bottom: 0, left: 0 }}
            labelColor="#9CA3AF"
            axisColor="#9CA3AF"
            tickColor="#9FAAAE"
            title=""
            type="COMMITMENTS"
            xAxisLabel=""
            yAxisLabel=""
            dataSource=""
            ariaLabel="Bar chart showing the number of commitments by year"
            ariaDescription="This chart displays the number of commitments made each year based on fetched API data."
          />
        )}
      </>
    )}
  />
);

export default BarChartWithOrganisation;
`}
/>


### BarChart with Organisations

Below is an example of the `BarChart` component wrapped inside the `Fetcher` component. This setup fetches data from an API and renders it in the bar chart.

<Canvas>
  <Story name="BarChart for Organisations">
    {() => (
      <Fetcher
        api="https://sfvc-migration.undrr.org/api/v2/content/commitments-metrics"
        queryParams={{items_per_page:1000}}
        render={({ isLoading, data }) => (
          <>
            {isLoading ? (
              <span>Loading data.</span>
            ) : (
              <BarChart
                data={data}
                width={1000}
                height={300}
                labelColor="#9CA3AF"
                axisColor="#9CA3AF"
                tickColor="#9FAAAE"
                title="Orgnisations by year"
                type="ORGANISATIONS"
                xAxisLabel="Year"
                yAxisLabel="Number of organizations"
                dataSource="Data from fetched API"
                ariaLabel="Bar chart showing the number of commiting organisations by year"
                ariaDescription="This chart displays the number of commiting organisations based on fetched API data."
              />
            )}
          </>
        )}
      />
    )}
  </Story>
</Canvas>

<Source
  language="jsx"
  code={`
import React from 'react';
import BarChart from './BarChart';
import Fetcher from '../../Fetcher/Fetcher';

const BarChartWithFetcher = () => (
  <Fetcher
    api="https://sfvc-migration.undrr.org/api/v2/content/commitments-metrics"
    queryParams={{items_per_page:1000}}
    render={({ isLoading, data }) => (
      <>
        {isLoading ? (
          <span>Loading data.</span>
        ) : (
          <BarChart
            data={data}
            width={1000}
            height={300}
            labelColor="#9CA3AF"
            axisColor="#9CA3AF"
            tickColor="#9FAAAE"
            title="Orgnisations by year"
            type="ORGANISATIONS"
            xAxisLabel="Year"
            yAxisLabel="Number of organizations"
            dataSource="Data from fetched API"
            ariaLabel="Bar chart showing the number of commiting organisations by year"
            ariaDescription="This chart displays the number of commiting organisations based on fetched API data."
          />
        )}
      </>
    )}
  />
);

export default BarChartWithFetcher;
`}
/>



### BarChart with Deliverables

Below is an example of the `BarChart` component wrapped inside the `Fetcher` component. This setup fetches data from an API and renders it in the bar chart.

<Canvas>
  <Story name="BarChart for Deliverables">
    {() => (
      <Fetcher
        api="https://sfvc-migration.undrr.org/api/v2/content/commitment-deliverables-metrics"
        queryParams={{items_per_page:1000}}
        render={({ isLoading, data }) => (
          <>
            {isLoading ? (
              <span>Loading data.</span>
            ) : (
              <BarChart
                data={data}
                width={1000}
                height={300}
                labelColor="#9CA3AF"
                axisColor="#9CA3AF"
                tickColor="#9FAAAE"
                title="Deliverables by year"
                type="DELIVERABLES"
                xAxisLabel="Year"
                yAxisLabel="Number of deliverables"
                dataSource="Data from fetched API"
                ariaLabel="Bar chart showing the number of deliverables by year"
                ariaDescription="This chart displays the number of deliverables based on fetched API data."
              />
            )}
          </>
        )}
      />
    )}
  </Story>
</Canvas>

<Source
  language="jsx"
  code={`
import React from 'react';
import BarChart from './BarChart';
import Fetcher from '../../Fetcher/Fetcher';

const BarChartWithFetcher = () => (
  <Fetcher
    api="https://sfvc-migration.undrr.org/api/v2/content/commitments-metrics"
    queryParams={{items_per_page:1000}}
    render={({ isLoading, data }) => (
      <>
        {isLoading ? (
          <span>Loading data.</span>
        ) : (
          <BarChart
            data={data}
            width={1000}
            height={300}
            labelColor="#9CA3AF"
            axisColor="#9CA3AF"
            tickColor="#9FAAAE"
            title="Deliverables by year"
            type="DELIVERABLES"
            xAxisLabel="Year"
            yAxisLabel="Number of deliverables"
            dataSource="Data from fetched API"
            ariaLabel="Bar chart showing the number of deliverables by year"
            ariaDescription="This chart displays the number of deliverables based on fetched API data."
          />
        )}
      </>
    )}
  />
);

export default BarChartWithFetcher;
`}
/>

### Accessibility

Ensure that the `render` function used within `Fetcher` is accessible and handles data presentation properly for all users.

### Changelog

1.0 â€” Initial release of the component
