import { Meta, Story, Canvas, Source } from '@storybook/blocks';
import BarChartProcessor from './BarChart';
import Fetcher from "../../Fetcher/Fetcher";
import * as BarChartStories from './BarChart.stories';
import { Loader } from "../../../Utilities/Loader/Loader";

<Meta of={BarChartStories} />

# BarChart

The `BarChart` component visualizes categorical data using D3.js. It displays bars representing data points with customizable colors, labels, and axis options.

## Props

* **`data`**: `Array<{ label: string, value: number, color: string }>` - Array of data points for the chart. *(required)*
* **`width`**: `number` - Width of the chart in pixels. *(required)*
* **`height`**: `number` - Height of the chart in pixels. *(required)*
* **`labelColor`**: `string` - Color for the bar labels. *(default: `#6B7280`)*
* **`backgroundColor`**: `string` - Background color of the chart. *(default: `#FFFFFF`)*
* **`title`**: `string` - Title of the chart. *(optional)*

## Usage

To use the `BarChart` component, import it into your React application and provide the required props.

### BarChart for Commitments

<Canvas>
  <Story name="BarChart for Commitments">
    {() => (
      <Fetcher
        api="https://sfvc-migration.undrr.org/api/v2/content/commitments-metrics"
        render={({ isLoading, data }) => (
          <>
            {isLoading ? <Loader /> : <BarChart data={data} type="COMMITMENTS" />}
          </>
        )}
      />
    )}
  </Story>
</Canvas>

### BarChart for Organizations

<Canvas>
  <Story name="BarChart for Organizations">
    {() => (
      <Fetcher
        api="https://sfvc-migration.undrr.org/api/v2/content/commitments-metrics"
        render={({ isLoading, data }) => (
          <>
            {isLoading ? <Loader /> : <BarChart data={data} type="ORGANIZATIONS" />}
          </>
        )}
      />
    )}
  </Story>
</Canvas>

<Source
  language="jsx"
  code={`
import React from 'react';
import BarChart from './BarChart';
import Fetcher from '../../Fetcher/Fetcher';

const BarChartWithFetcher = () => (
  <Fetcher
    api="https://sfvc-migration.undrr.org/api/v2/content/commitments-metrics"
    render={({ isLoading, data }) => (
      <>
        {isLoading ? <Loader /> : <BarChart data={data} type="ORGANIZATIONS" />}
      </>
    )}
  />
);

export default BarChartWithFetcher;
`}
/>

### BarChart for Deliverables

<Fetcher
  api="https://sfvc-migration.undrr.org/api/v2/content/commitment-deliverables-metrics"
  queryParams={{items_per_page:1000}}
  render={({ isLoading, data }) => (
    <>
      {isLoading ? (
        <Loader />
      ) : (
        <BarChartProcessor
          data={data}
          width={1000}
          height={300}
          margin={{ top: 10, right: 0, bottom: 10, left: 0 }}
          labelColor="#9CA3AF"
          axisColor="#9CA3AF"
          tickColor="none"
          title=""
          type="DELIVERABLES"
          xAxisLabel=""
          yAxisLabel=""
          dataSource=""
          ariaLabel="Bar chart showing the number of deliverables by year"
          ariaDescription="This chart displays the number of deliverables made each year based on fetched API data."
          apiData="true" 
        />
      )}
    </>
  )}
/>

### Accessibility

Ensure keyboard navigation and ARIA roles are properly implemented for enhanced accessibility.

### Changelog

1.0 â€” Initial release of the component

